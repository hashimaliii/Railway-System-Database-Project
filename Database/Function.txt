CREATE OR REPLACE FUNCTION GETFROMSTATION (RID IN NUMBER) RETURN VARCHAR2
AS
    x VARCHAR2(50);
    name VARCHAR2(50);
BEGIN
    SELECT ROUTENAME into name FROM ROUTE R WHERE R.ROUTEID = RID;
    if name LIKE '%Down'
        then
        SELECT STATIONNAME into x FROM STATION WHERE STATIONNO = (SELECT MAX (STATIONNO) FROM STOP S INNER JOIN STATION ST ON S.STATIONID = ST.STATIONID WHERE ROUTEID = RID);
    else
        SELECT STATIONNAME into x FROM STATION WHERE STATIONNO = (SELECT MIN (STATIONNO) FROM STOP S INNER JOIN STATION ST ON S.STATIONID = ST.STATIONID WHERE ROUTEID = RID);
    end if;
    return x;
END;
/
    
CREATE OR REPLACE FUNCTION GETTOSTATION (RID IN NUMBER) RETURN VARCHAR2
AS
    x VARCHAR2(50);
    name VARCHAR2(50);
BEGIN
    SELECT ROUTENAME into name FROM ROUTE R WHERE R.ROUTEID = RID;
    if name LIKE '%Down'
        then
        SELECT STATIONNAME into x FROM STATION WHERE STATIONNO = (SELECT MIN (STATIONNO) FROM STOP S INNER JOIN STATION ST ON S.STATIONID = ST.STATIONID WHERE ROUTEID = RID);
    else
        SELECT STATIONNAME into x FROM STATION WHERE STATIONNO = (SELECT MAX (STATIONNO) FROM STOP S INNER JOIN STATION ST ON S.STATIONID = ST.STATIONID WHERE ROUTEID = RID);
    end if;
    return x;
END;
/

CREATE OR REPLACE FUNCTION GETARRIVALTIME (RID IN NUMBER) RETURN VARCHAR2
AS
    x VARCHAR2(50);
    
BEGIN
    SELECT ARRIVALTIME into x FROM STOP S INNER JOIN STATION ST ON S.STATIONID = ST.STATIONID WHERE ROUTEID = RID AND STATIONNAME = GETTOSTATION (RID);
    return x;
END;
/
    
CREATE OR REPLACE FUNCTION GETDEPARTURETIME (RID IN NUMBER) RETURN VARCHAR2
AS
    x VARCHAR2(50);
BEGIN
    SELECT DEPARTURETIME into x FROM STOP S INNER JOIN STATION ST ON S.STATIONID = ST.STATIONID WHERE ROUTEID = RID AND STATIONNAME = GETFROMSTATION (RID);
    return x;
END;
/â€‹